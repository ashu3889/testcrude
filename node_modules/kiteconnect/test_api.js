var KiteConnect = require('./lib').KiteConnect;

var apiKey = 'gvu4pixmenhmg9im'
var apiSecret = 'qkfr1xg1gip2smdwafytppugvkhy8czj'
var requestToken = 'gx34ycji9ltu7hfxav0xvpha15b23612'
var accessToken = 'dhy8NouvYON9VMopv2soqrK1H2rpZ7R8'

var k = new KiteConnect({
	api_key: apiKey
})

if (accessToken) {
	k.setAccessToken(accessToken)
	init()
} else {
	k.generateSession(requestToken, apiSecret).then(function (resp) {
		console.log(resp)
		k.setAccessToken(resp.access_token)
		init()
	}).catch(function (error) {
		console.log("error", error)
		// console.log(error)
	})
}

function init() {
	console.log('init')
	k.getMargins().then(function (resp) {
		console.log(resp)
	}).catch(function (error) {
		console.log(error)
	})
}